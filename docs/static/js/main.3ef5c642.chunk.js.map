{"version":3,"sources":["../../src/constant.ts","../../src/media_session.tsx","../../src/index.tsx","data.js","music.js","app.js","index.js"],"names":["HAS_MEDIA_SESSION","window","mediaSession","navigator","MediaSession","props","title","artist","album","artwork","onPlay","onPause","onSeekBackward","onSeekForward","onPreviousTrack","onNextTrack","children","useEffect","MediaMetadata","React","id","cover","singers","name","src","Style","styled","div","playing","Music","music","alt","className","join","type","onClick","App","useState","index","setIndex","audioRef","useRef","useCallback","current","play","pause","currentTime","i","target","musicList","length","sizes","map","m","key","controls","autoPlay","loop","ref","style","width","margin","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.3ef5c642.chunk.js","sourcesContent":["export const HAS_MEDIA_SESSION =\n  window && window.navigator && 'mediaSession' in window.navigator;\n\ninterface Artwork {\n  src: string;\n  sizes: string;\n  type?: string;\n}\n\nexport interface MediaSessionProps {\n  title?: string;\n  artist?: string;\n  album?: string;\n  artwork: Artwork[];\n\n  onPlay?: (...args: any[]) => any;\n  onPause?: (...args: any[]) => any;\n  onSeekBackward?: (...args: any[]) => any;\n  onSeekForward?: (...args: any[]) => any;\n  onPreviousTrack?: (...args: any[]) => any;\n  onNextTrack?: (...args: any[]) => any;\n\n  [key: string]: any;\n}\n","import { useEffect } from 'react';\n\nimport { MediaSessionProps } from './constant';\n\n// @ts-ignore\nconst { mediaSession } = navigator;\n\nconst MediaSession = (props: MediaSessionProps) => {\n  const {\n    title = '',\n    artist = '',\n    album = '',\n    artwork = [],\n\n    onPlay,\n    onPause,\n    onSeekBackward,\n    onSeekForward,\n    onPreviousTrack,\n    onNextTrack,\n\n    children,\n  } = props;\n\n  useEffect(() => {\n    // @ts-ignore\n    mediaSession.metadata = new MediaMetadata({\n      title,\n      artist,\n      album,\n      artwork,\n    });\n    return () => {\n      mediaSession.metadata = null;\n    };\n  }, [title, artist, album, artwork]);\n\n  useEffect(() => {\n    mediaSession.setActionHandler('play', onPlay);\n    return () => {\n      mediaSession.setActionHandler('play', null);\n    };\n  }, [onPlay]);\n  useEffect(() => {\n    mediaSession.setActionHandler('pause', onPause);\n    return () => {\n      mediaSession.setActionHandler('pause', null);\n    };\n  }, [onPause]);\n  useEffect(() => {\n    mediaSession.setActionHandler('seekbackward', onSeekBackward);\n    return () => {\n      mediaSession.setActionHandler('seekbackward', null);\n    };\n  }, [onSeekBackward]);\n  useEffect(() => {\n    mediaSession.setActionHandler('seekforward', onSeekForward);\n    return () => {\n      mediaSession.setActionHandler('seekforward', null);\n    };\n  }, [onSeekForward]);\n  useEffect(() => {\n    mediaSession.setActionHandler('previoustrack', onPreviousTrack);\n    return () => {\n      mediaSession.setActionHandler('previoustrack', null);\n    };\n  }, [onPreviousTrack]);\n  useEffect(() => {\n    mediaSession.setActionHandler('nexttrack', onNextTrack);\n    return () => {\n      mediaSession.setActionHandler('nexttrack', null);\n    };\n  }, [onNextTrack]);\n\n  return children || null;\n};\n\nexport default MediaSession;\n","import React from 'react';\n\nimport { HAS_MEDIA_SESSION, MediaSessionProps } from './constant';\n\nimport MediaSession from './media_session';\n\nconst Wrapper = (props: MediaSessionProps) => {\n  if (!HAS_MEDIA_SESSION) {\n    return props.children || null;\n  }\n  return <MediaSession {...props} />;\n};\n\nexport default Wrapper;\n","export default [\n  {\n    id: 3,\n    cover: './source/ed85fe0f62133846c51abd31f4f87811.jpeg',\n    singers: ['孙盛希'],\n    name: 'Someday or One Day',\n    album: '想见你',\n    src: './source/孙盛希 - Someday or One Day.m4a',\n  },\n  {\n    id: 2,\n    cover: './source/d0c670fed000d3330cf26f704b4e7a86.jpeg',\n    singers: ['Cailin Russo', 'Chrissy Costanza'],\n    name: 'Phoenix',\n    album: 'Phoenix',\n    src: './source/Cailin Russo,Chrissy Costanza - Phoenix.m4a',\n  },\n  {\n    id: 1,\n    cover: './source/b5d358e6c54c15bf0d80ad288aba377b.jpeg',\n    singers: ['陈蕾'],\n    name: '当我迷失时听着的歌',\n    album: '当我迷失时听着的歌',\n    src: './source/陈蕾 - 当我迷失时听着的歌.mp3',\n  },\n];\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst Style = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  background-color: ${({ playing }) =>\n    playing ? 'rgba(49, 194, 124, 0.2)' : 'white'};\n  > .cover {\n    width: 60px;\n    height: 60px;\n  }\n  > .info {\n    flex: 1;\n    min-width: 0;\n    margin-left: 20px;\n    > .name {\n      font-size: 14px;\n    }\n    > .singers {\n      font-size: 12px;\n      color: gray;\n    }\n  }\n`;\n\nconst Music = ({ music, playing, onPlay }) => {\n  return (\n    <Style playing={playing}>\n      <img src={music.cover} alt=\"cover\" className=\"cover\" />\n      <div className=\"info\">\n        <div className=\"name\">{music.name}</div>\n        <div className=\"singers\">{music.singers.join(',')}</div>\n        <div className=\"actions\">\n          <button type=\"button\" onClick={() => onPlay(music)}>\n            {playing ? 'playing' : 'play'}\n          </button>\n        </div>\n      </div>\n    </Style>\n  );\n};\n\nexport default Music;\n","import React, { useState, useRef, useCallback } from 'react';\nimport MediaSession from '@mebtte/react-media-session';\n\nimport musicList from './data.js';\n\nimport Music from './music';\n\nconst App = () => {\n  const [index, setIndex] = useState(0);\n  const audioRef = useRef();\n\n  const onPlay = useCallback(() => audioRef.current.play(), []);\n  const onPause = useCallback(() => audioRef.current.pause(), []);\n  const onSeekBackward = useCallback(\n    () => (audioRef.current.currentTime -= 10),\n    [],\n  );\n  const onSeekForward = useCallback(\n    () => (audioRef.current.currentTime += 10),\n    [],\n  );\n  const onPreviousTrack = useCallback(\n    () =>\n      setIndex((i) => {\n        const target = i - 1;\n        if (target < 0) {\n          return target + musicList.length;\n        }\n        return target;\n      }),\n    [],\n  );\n  const onNextTrack = useCallback(\n    () => setIndex((i) => (i + 1) % musicList.length),\n    [],\n  );\n\n  const music = musicList[index];\n  return (\n    <MediaSession\n      title={music.name}\n      artist={music.singers.join(',')}\n      artwork={[\n        {\n          src: music.cover,\n          sizes: '512x512',\n        },\n      ]}\n      album={music.album}\n      onPlay={onPlay}\n      onPause={onPause}\n      onSeekBackward={onSeekBackward}\n      onSeekForward={onSeekForward}\n      onPreviousTrack={onPreviousTrack}\n      onNextTrack={onNextTrack}\n    >\n      <div className=\"music-list\">\n        {musicList.map((m, i) => (\n          <Music\n            key={m.id}\n            music={m}\n            playing={i === index}\n            onPlay={() => setIndex(i)}\n          />\n        ))}\n      </div>\n      <audio\n        src={music.src}\n        controls\n        autoPlay\n        loop\n        ref={audioRef}\n        style={{ width: '100%', margin: '20px 0' }}\n      />\n    </MediaSession>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './app';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}