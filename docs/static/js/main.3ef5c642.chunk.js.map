{"version":3,"sources":["../../src/constant.ts","../../src/media_session.tsx","../../src/index.tsx","data.js","music.js","app.js","index.js"],"names":["HAS_MEDIA_SESSION","window","mediaSession","MediaSession","props","title","artist","album","artwork","children","useEffect","MediaMetadata","React","id","cover","singers","name","src","Style","styled","div","playing","Music","music","onPlay","alt","className","join","type","onClick","App","useState","index","setIndex","audioRef","useRef","useCallback","current","play","onPause","pause","onSeekBackward","currentTime","onSeekForward","onPreviousTrack","i","target","musicList","length","onNextTrack","sizes","map","m","key","controls","autoPlay","loop","ref","style","width","margin","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.3ef5c642.chunk.js","sourcesContent":["export const HAS_MEDIA_SESSION =\n  window && window.navigator && 'mediaSession' in window.navigator;\n\ninterface Artwork {\n  src: string;\n  sizes: string;\n  type?: string;\n}\n\nexport interface MediaSessionProps {\n  title?: string;\n  artist?: string;\n  album?: string;\n  artwork: Artwork[];\n\n  onPlay?: (...args: any[]) => any;\n  onPause?: (...args: any[]) => any;\n  onSeekBackward?: (...args: any[]) => any;\n  onSeekForward?: (...args: any[]) => any;\n  onPreviousTrack?: (...args: any[]) => any;\n  onNextTrack?: (...args: any[]) => any;\n\n  [key: string]: any;\n}\n","import { useEffect } from 'react';\n\nimport { MediaSessionProps } from './constant';\n\n// @ts-ignore\nconst { mediaSession } = navigator;\n\nconst MediaSession = (props: MediaSessionProps) => {\n  const {\n    title = '',\n    artist = '',\n    album = '',\n    artwork = [],\n\n    onPlay,\n    onPause,\n    onSeekBackward,\n    onSeekForward,\n    onPreviousTrack,\n    onNextTrack,\n\n    children,\n  } = props;\n\n  useEffect(() => {\n    // @ts-ignore\n    mediaSession.metadata = new MediaMetadata({\n      title,\n      artist,\n      album,\n      artwork,\n    });\n    return () => {\n      mediaSession.metadata = null;\n    };\n  }, [title, artist, album, artwork]);\n\n  useEffect(() => {\n    mediaSession.setActionHandler('play', onPlay);\n    return () => {\n      mediaSession.setActionHandler('play', null);\n    };\n  }, [onPlay]);\n  useEffect(() => {\n    mediaSession.setActionHandler('pause', onPause);\n    return () => {\n      mediaSession.setActionHandler('pause', null);\n    };\n  }, [onPause]);\n  useEffect(() => {\n    mediaSession.setActionHandler('seekbackward', onSeekBackward);\n    return () => {\n      mediaSession.setActionHandler('seekbackward', null);\n    };\n  }, [onSeekBackward]);\n  useEffect(() => {\n    mediaSession.setActionHandler('seekforward', onSeekForward);\n    return () => {\n      mediaSession.setActionHandler('seekforward', null);\n    };\n  }, [onSeekForward]);\n  useEffect(() => {\n    mediaSession.setActionHandler('previoustrack', onPreviousTrack);\n    return () => {\n      mediaSession.setActionHandler('previoustrack', null);\n    };\n  }, [onPreviousTrack]);\n  useEffect(() => {\n    mediaSession.setActionHandler('nexttrack', onNextTrack);\n    return () => {\n      mediaSession.setActionHandler('nexttrack', null);\n    };\n  }, [onNextTrack]);\n\n  return children || null;\n};\n\nexport default MediaSession;\n","import React from 'react';\n\nimport { HAS_MEDIA_SESSION, MediaSessionProps } from './constant';\n\nimport MediaSession from './media_session';\n\nconst Wrapper = (props: MediaSessionProps) => {\n  if (!HAS_MEDIA_SESSION) {\n    return props.children || null;\n  }\n  return <MediaSession {...props} />;\n};\n\nexport default Wrapper;\n","export default [\n  {\n    id: 3,\n    cover: './source/ed85fe0f62133846c51abd31f4f87811.jpeg',\n    singers: ['孙盛希'],\n    name: 'Someday or One Day',\n    album: '想见你',\n    src: './source/孙盛希 - Someday or One Day.m4a',\n  },\n  {\n    id: 2,\n    cover: './source/d0c670fed000d3330cf26f704b4e7a86.jpeg',\n    singers: ['Cailin Russo', 'Chrissy Costanza'],\n    name: 'Phoenix',\n    album: 'Phoenix',\n    src: './source/Cailin Russo,Chrissy Costanza - Phoenix.m4a',\n  },\n  {\n    id: 1,\n    cover: './source/b5d358e6c54c15bf0d80ad288aba377b.jpeg',\n    singers: ['陈蕾'],\n    name: '当我迷失时听着的歌',\n    album: '当我迷失时听着的歌',\n    src: './source/陈蕾 - 当我迷失时听着的歌.mp3',\n  },\n];\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst Style = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  background-color: ${({ playing }) =>\n    playing ? 'rgba(49, 194, 124, 0.2)' : 'white'};\n  > .cover {\n    width: 60px;\n    height: 60px;\n  }\n  > .info {\n    flex: 1;\n    min-width: 0;\n    margin-left: 20px;\n    > .name {\n      font-size: 14px;\n    }\n    > .singers {\n      font-size: 12px;\n      color: gray;\n    }\n  }\n`;\n\nconst Music = ({ music, playing, onPlay }) => {\n  return (\n    <Style playing={playing}>\n      <img src={music.cover} alt=\"cover\" className=\"cover\" />\n      <div className=\"info\">\n        <div className=\"name\">{music.name}</div>\n        <div className=\"singers\">{music.singers.join(',')}</div>\n        <div className=\"actions\">\n          <button type=\"button\" onClick={() => onPlay(music)}>\n            {playing ? 'playing' : 'play'}\n          </button>\n        </div>\n      </div>\n    </Style>\n  );\n};\n\nexport default Music;\n","import React, { useState, useRef, useCallback } from 'react';\nimport MediaSession from '@mebtte/react-media-session';\n\nimport musicList from './data.js';\n\nimport Music from './music';\n\nconst App = () => {\n  const [index, setIndex] = useState(0);\n  const audioRef = useRef();\n\n  const onPlay = useCallback(() => audioRef.current.play(), []);\n  const onPause = useCallback(() => audioRef.current.pause(), []);\n  const onSeekBackward = useCallback(\n    () => (audioRef.current.currentTime -= 10),\n    [],\n  );\n  const onSeekForward = useCallback(\n    () => (audioRef.current.currentTime += 10),\n    [],\n  );\n  const onPreviousTrack = useCallback(\n    () =>\n      setIndex((i) => {\n        const target = i - 1;\n        if (target < 0) {\n          return target + musicList.length;\n        }\n        return target;\n      }),\n    [],\n  );\n  const onNextTrack = useCallback(\n    () => setIndex((i) => (i + 1) % musicList.length),\n    [],\n  );\n\n  const music = musicList[index];\n  return (\n    <MediaSession\n      title={music.name}\n      artist={music.singers.join(',')}\n      artwork={[\n        {\n          src: music.cover,\n          sizes: '512x512',\n        },\n      ]}\n      album={music.album}\n      onPlay={onPlay}\n      onPause={onPause}\n      onSeekBackward={onSeekBackward}\n      onSeekForward={onSeekForward}\n      onPreviousTrack={onPreviousTrack}\n      onNextTrack={onNextTrack}\n    >\n      <div className=\"music-list\">\n        {musicList.map((m, i) => (\n          <Music\n            key={m.id}\n            music={m}\n            playing={i === index}\n            onPlay={() => setIndex(i)}\n          />\n        ))}\n      </div>\n      <audio\n        src={music.src}\n        controls\n        autoPlay\n        loop\n        ref={audioRef}\n        style={{ width: '100%', margin: '20px 0' }}\n      />\n    </MediaSession>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './app';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}